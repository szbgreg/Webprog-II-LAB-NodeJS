<div class="container-fluid hero-header bg-light py-2 mb-5">
    <div class="container py-5">
        <div class="row g-5 align-items-center">
            <div class="col-lg-6">
                <h1 class="display-5 mb-3 animated slideInDown">
                    <span class="text-primary">CRUD</span> alkalmazás
                </h1>
                <p class="text-secondary mb-4">
                    Itt van lehetőség kezelni a sütik tábla adatait
                </p>
            </div>
            <div class="col-lg-6 text-center animated fadeIn">
                <img class="img-fluid animated pulse infinite" style="animation-duration: 3s; max-height: 260px;"
                    src="/images/crud.png" alt="Sütemény crud">
            </div>
        </div>
    </div>
</div>

<%- include('../flash-messages') -%>

<div class="container mt-4 pb-5">
    <h1 class="mb-4">Sütik kezelése</h1>
    <div class="d-flex justify-content-end mx-auto w-75 my-2">
        <a href="/crud/sutik/new" class="btn btn-primary d-block">Új süti hozzáadása</a>
    </div>
    <div class="table-responsive shadow-sm rounded-3 w-75 mx-auto">
        <table class="table table-hover table-striped table-light align-middle mb-0">
            <thead class="table-light border-bottom border-2 border-grey-dark">
                <tr>
                    <th class="text-primary" style="width: 5%;">#</th>
                    <th class="text-primary" style="width: 30%;">Név</th>
                    <th class="text-primary" style="width: 15%;">Típus</th>
                    <th class="text-primary text-center pe-5" style="width: 10%;">Díjazott</th>
                    <th class="text-primary text-center" style="width: 20%;">Művelet</th>
                </tr>
            </thead>
            <tbody>
                <% sutik.forEach(function(suti) { %>
                    <tr>
                        <td class="fw-bold text-muted">
                            <%= suti.id %>
                        </td>
                        <td class="fw-bold">
                            <%= suti.nev %>
                        </td>
                        <td>
                            <%= suti.tipus %>
                        </td>
                        <td class="text-center">
                            <% if(suti.dijazott) { %>
                                <span class="text-primary">igen</span>
                                <% } %>
                        </td>

                        <td class="d-flex gap-2 justify-content-center">
                            <a href="/crud/sutik/<%= suti.id %>/edit"><i class="bi bi-pencil text-warning fs-4"></i></a>
                            <button type="button" class="btn btn-link p-0 border-0 bg-transparent"
                                data-bs-toggle="modal" data-bs-target="#deleteModal<%= suti.id %>">
                                <i class="bi bi-trash text-danger fs-4"></i>
                            </button>
                        </td>
                    </tr>
                    <% }); %>
            </tbody>
        </table>
    </div>

    <!--  Modal  -->
    <% sutik.forEach(function(suti) { %>
        <div class="modal fade" id="deleteModal<%= suti.id %>" tabindex="-1"
            aria-labelledby="deleteModalLabel<%= suti.id %>" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteModalLabel<%= suti.id %>">
                            Törlés megerősítése
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Bezárás"></button>
                    </div>
                    <div class="modal-body text-center">
                        <p>Biztosan törölni akarod ezt a sütit?</p>
                        <strong>
                            <%= suti.nev %>
                        </strong>
                    </div>
                    <div class="modal-footer justify-content-center">
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                            Mégse
                        </button>
                        <form action="/crud/sutik/<%= suti.id %>/delete" method="post" class="d-inline">
                            <button type="submit" class="btn btn-danger">
                                Törlés
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <% }); %>

            <!-- Pagination Start -->
            <div class="d-flex justify-content-center mt-4">
                <nav aria-label="Süti lista lapozás">
                    <ul class="pagination pagination">
                        <!-- Első oldal -->
                        <% if (pagination.currentPage> 1) { %>
                            <li class="page-item">
                                <a class="page-link" href="?oldal=1" aria-label="Első">
                                    <span aria-hidden="true">&laquo;&laquo;</span>
                                </a>
                            </li>
                            <% } %>

                                <!-- Előző oldal -->
                                <% if (pagination.hasPrevPage) { %>
                                    <li class="page-item">
                                        <a class="page-link" href="?oldal=<%= pagination.prevPage %>"
                                            aria-label="Előző">
                                            <span aria-hidden="true">&laquo;</span>
                                        </a>
                                    </li>
                                    <% } %>

                                        <!-- Oldalszámok -->
                                        <% const startPage=Math.max(1, pagination.currentPage - 2); const
                                            endPage=Math.min(pagination.totalPages, pagination.currentPage + 2); %>

                                            <% for (let i=startPage; i <=endPage; i++) { %>
                                                <li
                                                    class="page-item <%= i === pagination.currentPage ? 'active' : '' %>">
                                                    <a class="page-link" href="?oldal=<%= i %>">
                                                        <%= i %>
                                                    </a>
                                                </li>
                                                <% } %>

                                                    <!-- Következő oldal -->
                                                    <% if (pagination.hasNextPage) { %>
                                                        <li class="page-item">
                                                            <a class="page-link"
                                                                href="?oldal=<%= pagination.nextPage %>"
                                                                aria-label="Következő">
                                                                <span aria-hidden="true">&raquo;</span>
                                                            </a>
                                                        </li>
                                                        <% } %>

                                                            <!-- Utolsó oldal -->
                                                            <% if (pagination.currentPage < pagination.totalPages) { %>
                                                                <li class="page-item">
                                                                    <a class="page-link"
                                                                        href="?oldal=<%= pagination.totalPages %>"
                                                                        aria-label="Utolsó">
                                                                        <span aria-hidden="true">&raquo;&raquo;</span>
                                                                    </a>
                                                                </li>
                                                                <% } %>
                    </ul>
                </nav>
            </div>
</div>